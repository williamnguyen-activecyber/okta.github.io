<!doctype html>
<html class="no-js" lang="en" dir="ltr">
<head>
  <script>
    var searchDomain = 'https://developer.okta.com';
    var isProduction = window.location.hostname === 'developer.okta.com';
    if (isProduction) {
      // TypeKit
      (function(d) {
        var config = {
          kitId: 'jff5neq',
          scriptTimeout: 3000,
          async: true
        },
        h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/bwf-loadingb/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
      })(document);

      // Google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-15777010-3', 'auto');
      ga('send', 'pageview');

      // START Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TJ45R6');
      // END Google Tag Manager
    }
	</script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
 	

  <link type="text/css" rel="stylesheet" href="https://developer.okta.com/sites/all/themes/developer/css/master.css" media="all" />
  <meta class="swiftype" name="title" data-type="string" content="PHP | Okta Developer" />
  <meta class="swiftype" name="summary" data-type="string" content="Quickstart guide for using the Okta Sign-In Widget with PHP" />

  <link type="text/css" rel="stylesheet" href="/assets/animate-ec43d72c3ed45e08a460b8a2966d8dba6006aebfa0530935c3973fa493a8771f.css">
  <link type="text/css" rel="stylesheet" href="/assets/okta-e28878f54113d0771499e2f130fd8a00486e358897cf41afc0da4b6ad7d2dafe.css">
  
  
  <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/favicon.ico">
  <title>PHP | Okta Developer</title>
  <meta name="description" content="Quickstart guide for using the Okta Sign-In Widget with PHP">
  <link rel="canonical" href="https://developer.okta.com/code/php/quickstart-signin-widget">
  <link rel="alternate" type="application/rss+xml" title="Okta Developer" href="https://developer.okta.com/feed.xml"><!-- GA -->
</head>

<body>
  <div class="Page Page--docs-page">
    <!-- START Header -->
    




<header class="Header is-fixed">

  <div class="Wrap">

    <a class="Logo" href="https://developer.okta.com">
      <svg version="1.1" id="OktaLogo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 431.9 151.4" style="enable-background:new 0 0 431.9 151.4;" xml:space="preserve"><g><g><g><path d="M102.2,41.4c-21,0-38.1,17.1-38.1,38.1s17.1,38.1,38.1,38.1s38.1-17.1,38.1-38.1l0,0C140.3,58.5,123.2,41.4,102.2,41.4z M102.2,98.5c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19c0.1,10.5-8.4,19-18.9,19.1C102.3,98.6,102.2,98.6,102.2,98.5L102.2,98.5z"/><path d="M169.1,92.3c0-1.9,1.5-3.4,3.4-3.4c0.9,0,1.8,0.4,2.4,1c9.5,9.7,25.3,26.3,25.4,26.4c0.4,0.5,0.8,0.8,1.4,0.9l1.6,0.2h17.2c1.8,0,3.3-1.4,3.4-3.2c0-0.8-0.3-1.5-0.8-2.2l-28.6-29.2l-1.5-1.5c-3.2-3.9-2.9-5.4,0.8-9.3l22.6-25.1c1.1-1.4,0.8-3.5-0.6-4.6c-0.6-0.4-1.3-0.7-2-0.7h-17c-0.6,0.2-1.1,0.5-1.5,0.9L175,64.4c-1.3,1.4-3.4,1.5-4.8,0.2c-0.7-0.6-1.1-1.5-1.1-2.5V18.9c0-1.7-1.3-3-3-3c-0.1,0-0.2,0-0.3,0h-12.7c-2.2,0-3.3,1.5-3.3,2.8v95.8c0,2.2,1.8,2.8,3.3,2.8h12.7c1.7,0.1,3.2-1.2,3.3-2.9c0,0,0,0,0,0V92.3z"/><path d="M273,114l-1.4-12.8c-0.2-1.7-1.7-2.9-3.4-2.7c0,0,0,0-0.1,0l-2.9,0.2c-10.1,0-18.5-7.9-19-18c0-0.3,0-0.7,0-1V64.2c-0.1-2,1.5-3.6,3.5-3.7c0,0,0,0,0,0h17c1.7-0.1,3.1-1.5,3-3.2c0,0,0-0.1,0-0.1v-12c0-2.3-1.5-3.6-2.8-3.6h-17.1c-1.9,0.1-3.5-1.5-3.6-3.4c0,0,0,0,0,0V18.9c-0.1-1.7-1.5-3.1-3.2-3c0,0-0.1,0-0.1,0h-12.7c-1.6-0.1-3,1.1-3.1,2.7c0,0.1,0,0.1,0,0.2c0,0,0,61.7,0,62c0.5,21,17.9,37.6,38.9,37c1.4,0,2.9-0.2,4.3-0.3C272,117.2,273.2,115.7,273,114z"/></g><path d="M364.7,98c-10.8,0-12.4-3.8-12.4-18.3l0,0V44.8c0-1.8-1.4-3.2-3.2-3.2c0,0-0.1,0-0.1,0h-12.8c-1.8,0-3.2,1.4-3.3,3.2v1.6C314.6,36,291.3,42.5,281,60.8c-10.4,18.3-3.9,41.6,14.4,51.9c14,7.9,31.4,6.2,43.5-4.2c3.6,5.5,9.3,9.1,18.3,9.1c1.5,0,9.7,0.3,9.7-3.5v-13.6C367,99.2,366,98.1,364.7,98z M314.2,98.6c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19l0,0C333.2,90.1,324.7,98.6,314.2,98.6z"/></g><path d="M19.4,74c2.2-1.9,4.1-4.1,5.7-6.6c3.5-5.3,5.4-11.5,5.2-17.9V27c0-4.9,0.9-8.4,2.7-10.5c1.8-2.1,4.8-3,9.2-3h12.6c1.2,0,2.1-0.9,2.2-2.1l0,0V2.2C57,1,56,0,54.8,0c0,0,0,0,0,0H41.5c-7.8,0-12.9,2.1-18,7.6s-7.1,12.3-7.1,21.7v14.2c0,2.2-0.1,4-0.2,5.7v2.2c-0.5,3.2-1.8,6.2-3.6,8.9C9.4,64.7,5.1,70.9,0.9,74l0,0l-0.3,0.3l0,0l-0.2,0.3H0.2v0.3l0,0c-0.1,0.3-0.1,0.7,0,1l0,0v0.3h0.1l0.2,0.3l0,0l0.3,0.3l0,0c4.2,3.1,8.5,9.3,11.3,13.7c1.8,2.7,3.1,5.7,3.6,8.9v2.2c0.1,1.6,0.2,3.5,0.2,5.7v14.3c0,9.4,2.4,16.7,7.1,21.7s10.2,7.6,18,7.6h13.8c1.2,0,2.2-1,2.2-2.2V140l0,0c0-1.2-1-2.2-2.2-2.2H42.2c-4.4,0-7.5-1-9.2-3s-2.7-5.6-2.7-10.5v-22.4c0.2-6.4-1.7-12.6-5.2-17.9c-1.6-2.5-3.5-4.7-5.7-6.6l0,0c-0.9-0.7-1.1-2-0.4-2.9C19.2,74.3,19.3,74.2,19.4,74L19.4,74z"/><path d="M412.5,74c-2.2-1.9-4.1-4.1-5.7-6.6c-3.5-5.3-5.4-11.5-5.2-17.9V27c0-4.9-0.9-8.4-2.7-10.5s-4.8-3-9.2-3h-12.6c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0l0,0V2.2c0-1.2,1-2.2,2.2-2.2c0,0,0,0,0,0h13.4c7.8,0,12.9,2.1,18,7.6s7.1,12.3,7.1,21.7v14.2c0,2.2,0.1,4,0.2,5.7v2.2c0.5,3.2,1.8,6.2,3.6,8.9c2.8,4.5,7.1,10.7,11.3,13.7l0,0l0.3,0.3l0,0l0.2,0.3h0.1v0.3l0,0c0.1,0.3,0.1,0.7,0,1l0,0v0.3h-0.1l-0.2,0.3l0,0l-0.3,0.3l0,0c-4.2,3.1-8.5,9.3-11.3,13.7c-1.8,2.7-3.1,5.7-3.6,8.9v2.2c-0.1,1.6-0.2,3.5-0.2,5.7v14.3c0,9.4-2.4,16.7-7.1,21.7s-10.2,7.6-18,7.6h-13.4c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0V140l0,0c0-1.2,1-2.2,2.2-2.2l0,0h12.7c4.4,0,7.5-1,9.2-3s2.7-5.6,2.7-10.5v-22.4c-0.2-6.3,1.6-12.6,5.1-17.9c1.6-2.5,3.5-4.7,5.7-6.6l0,0c0.9-0.7,1.1-2,0.4-2.9C412.7,74.3,412.6,74.2,412.5,74L412.5,74z"/></g></svg>
    </a>

    <nav class="Header-nav PrimaryNav">
      <ul class="menu">
        <li class="first leaf">
          <a href="https://developer.okta.com/product/">Product</a>
        </li>
        <li class="leaf">
          <a href="https://developer.okta.com/pricing/">Pricing</a>
        </li>
        <li class="leaf">
          <a href="/blog/">Blog</a>
        </li>
        <li class="leaf">
          <a href="/documentation/" class="active">Docs</a>
        </li>
        <li class="last expanded">
          <span class="nolink">Support</span>
          <ul class="menu">
            <li class="first leaf"><a href="https://devforum.okta.com/">Okta Developer Forums</a></li>
            <li class="last leaf"><a href="mailto:developers@okta.com">developers@okta.com</a></li>
          </ul>
        </li>
      </ul>
      <a class="PrimaryNav-toggle" href="#">
        <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g class="MenuIcon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
                <path d="M1,16 L19,16" class="MenuIcon-line1" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,4 L19,4" class="MenuIcon-line2" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,10 L19,10" class="MenuIcon-line3" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,10 L19,10" class="MenuIcon-line4" stroke="#FFFFFF" stroke-width="2"></path>
            </g>
        </svg>
        <svg class="CloseIcon" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="ALl-Boards" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="Desktop" transform="translate(-915.000000, -235.000000)" fill="#FFFFFF">
              <g id="Search-bar-Active" transform="translate(30.000000, 26.000000)">
                <polygon id="Icon/Cross" points="901 210.6 899.4 209 893 215.4 886.6 209 885 210.6 891.4 217 885 223.4 886.6 225 893 218.6 899.4 225 901 223.4 894.6 217"></polygon>
              </g>
            </g>
          </g>
        </svg>
      </a>

      <div class="PrimaryNav-cta">
        <a href="https://developer.okta.com/signup/" class="Button--red">Sign up</a>
      </div>

      <a class="SearchIcon" href="#"></a>
      <form id="form_search" class="SearchBar Formisimo_clocked_69929" method="get" action="https://developer.okta.com/search/" name="form_search" __bizdiag="-784164280" __biza="WJ__">
        <input type="text" name="stq" autocomplete="off" id="st-search-input-auto" class="st-search-input" placeholder="Search">
        <input type="submit" name="submit" value="GO">
      </form>

    </nav>

  </div>

</header>

    <!-- END Header -->
    <!-- START Page Center w/Sub Nav & Content -->
    <section class="PageContent DynamicSidebar has-tableOfContents">
      <!-- START Fixed sidebar -->
      <aside class="Sidebar">
        <h2 class="Sidebar-location Sidebar-toggle h6">Navigation</h2>
        <div class="Sidebar-close Sidebar-toggle"></div>
        <div>
          <h3 class="Sidebar-title">Client Integrations</h3>
          <ul class="Sidebar-nav">
            
            
              
              
              
              
              
              
              <li >
                <a href="/code/angular/">ANGULAR</a>
              </li>
            
              
                
              
                
              
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
              
                
              
              
              
              
              
              
              <li >
                <a href="/code/ios/">IOS</a>
              </li>
            
              
                
              
              
                
              
                
              
                
              
                
              
                
              
              
              
              
              
              
              <li >
                <a href="/code/javascript/">JAVASCRIPT</a>
              </li>
            
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
              
                
              
              
                
              
                
              
                
              
                
              
              
                
              
                
              
                
              
                
              
              
              
              
              
              
              <li >
                <a href="/code/react/">REACT</a>
              </li>
            
              
                
              
                
          </ul>
          <h3 class="Sidebar-title">Server Integrations</h3>
          <ul class="Sidebar-nav">
            
            
              
              
                
              
                
              
                
              
              
              
              
              
              
              <li >
                <a href="/code/dotnet/">.NET</a>
              </li>
            
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
              
                
              
              
                
              
                
              
              
              
              
              
              
              <li >
                <a href="/code/java/">JAVA</a>
              </li>
            
              
                
              
                
              
                
              
                
              
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
              
              
              
              
              
              <li >
                <a href="/code/nodejs/">NODE.JS</a>
              </li>
            
              
              
              
              
              
              
              <li class="is-active">
                <a href="/code/php/">PHP</a>
              </li>
            
              
                
              
                
              
                
              
              
              
              
              
              
              <li >
                <a href="/code/python/">PYTHON</a>
              </li>
            
              
                
              
                
              
                
              
              
                
              
                
              
                
          </ul>
        </div>
      </aside>
      <!-- END Fixed sidebar -->
      <!-- START Page Content -->
      <div class="PageContent-main">
        <h1 id="overview">Overview</h1>
<p>The Okta Sign-In Widget is a JavaScript widget from Okta that gives you a fully featured and customizable login experience which can be used to authenticate users on any web site.</p>

<p><img src="/assets/okta-signin-da15ebe650d0258b247d4981a956abec094e9891c0b7f9e2ce7c5731f103d6be.png" alt="Screenshot of basic Okta Sign-In Widget" /></p>

<h1 id="configuring-your-organization">Configuring your Organization</h1>

<p>To see the Sign-in Widget in action, you will need:</p>
<ul>
  <li>An Okta Developer org, which you can sign-up for here: <a href="https://developer.okta.com/signup/">https://developer.okta.com/signup/</a></li>
  <li>A client application</li>
  <li>An authorization server</li>
</ul>

<h2 id="create-your-application">Create your application</h2>
<ol>
  <li>Create a new <strong>Web</strong> application by selecting <strong>Create New Application</strong> from the <em>Applications</em> page.</li>
  <li>Update the <strong>Login Redirect URIs</strong> to include <code class="highlighter-rouge">http://localhost:3000/oauth2-callback.php</code>.</li>
  <li>Select <strong>Implicit</strong> under <strong>Grant type allowed</strong>.</li>
  <li>Press <strong>Done</strong> to redirect back to the <em>General Settings</em> of your application.</li>
  <li>Finally, copy the <strong>Client ID</strong> and <strong>Client Secret</strong>, as it will be needed for the client configuration.</li>
</ol>

<blockquote>
  <p><strong>Note:</strong> CORS is automatically enabled for the granted login redirect URIs.</p>
</blockquote>

<h2 id="create-an-authorization-server">Create an Authorization Server</h2>

<p>An authorization server defines your security boundary, for example “staging” or “production”. Within each authorization server you can define your own OAuth scopes, claims, and access policies. This allows your apps and APIs to anchor to a central authorization point and leverage the rich identity features of Okta, such as Universal Directory for transforming attributes, adaptive MFA for end-users, analytics, and system log.</p>

<p>Navigate to <code class="highlighter-rouge">https://{yourOktaDomain}.com/oauth2/default</code> to see if your default authorization server is setup. If not, <a href="/docs/how-to/set-up-auth-server.html">follow this setup guide</a>.</p>

<blockquote>
  <p><strong>Note:</strong> Remember to set the <code class="highlighter-rouge">audience</code> of the authorization server to point to your app’s host. For example, if you are running your PHP application on <code class="highlighter-rouge">http://localhost:3000</code>, set the <code class="highlighter-rouge">audience</code> to <code class="highlighter-rouge">http://localhost:3000</code>.</p>
</blockquote>

<h1 id="php-application-set-up">PHP Application Set-up</h1>
<p>Now that we have all the configuration at Okta done, we can begin setting up our PHP application. There are a
couple of different ways to include the sign-in widget in your application. You can use the NPM module by installing
<code class="highlighter-rouge">@okta/okta-signin-widget</code> in your project, or by using the Okta CDN, which is what we’ll be using. Once you have the
 sign-in widget, there’s a little bit of configuration you have to do to talk with your new authorization server.</p>

<h2 id="installing-and-configuring-the-sign-in-widget">Installing and Configuring the Sign In Widget</h2>
<p>There are 2 files we will require for the sign in widget to work, a JS file and a CSS file. You will also be able to supply a 3rd file from our CDN or supply your own for the theme of the signin widget.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- Latest CDN production Javascript and CSS: 1.13.0 --&gt;</span>
<span class="nt">&lt;script
  </span><span class="na">src=</span><span class="s">"https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.13.0/js/okta-sign-in.min.js"</span>
  <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;link</span>
  <span class="na">href=</span><span class="s">"https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.13.0/css/okta-sign-in.min.css"</span>
  <span class="na">type=</span><span class="s">"text/css"</span>
  <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">/&gt;</span>

<span class="c">&lt;!-- Theme file: Customize or replace this file if you want to override our default styles --&gt;</span>
<span class="nt">&lt;link</span>
  <span class="na">href=</span><span class="s">"https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.13.0/css/okta-theme.css"</span>
  <span class="na">type=</span><span class="s">"text/css"</span>
  <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">/&gt;</span>
</code></pre>
</div>
<p>Add the above to your login page. For our example, we will be using <code class="highlighter-rouge">login.php</code> as our login page. Also on the login page, we need to add a little bit of configuration for the sign-in widget to work. The first thing is to create an area on the page to give us a target for the widget to be placed.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"okta-login"</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre>
</div>

<blockquote>
  <p>This element, a div in our example, should remain empty and can be placed where you would like the sign-in widget to be rendered..</p>
</blockquote>

<p>We also need to add a script block to initialize and configure the widget.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
    <span class="kd">var</span> <span class="nx">orgUrl</span> <span class="o">=</span> <span class="s1">'https://{yourOktaDomain}.com'</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">signIn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OktaSignIn</span><span class="p">({</span>
        <span class="na">baseUrl</span><span class="p">:</span> <span class="nx">orgUrl</span><span class="p">,</span>
        <span class="na">clientId</span><span class="p">:</span> <span class="s1">'sRmBpCfR3xKyf4goHZhM'</span><span class="p">,</span>
        <span class="na">redirectUri</span><span class="p">:</span> <span class="s1">'http://localhost:3000/oauth2-callback.php'</span><span class="p">,</span>
        <span class="na">authParams</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">responseType</span><span class="p">:</span> <span class="s1">'code'</span><span class="p">,</span>
            <span class="na">issuer</span><span class="p">:</span> <span class="s1">'https://{yourOktaDomain}.com/oauth2/{authorizationServerId}'</span><span class="p">,</span>
            <span class="na">display</span><span class="p">:</span> <span class="s1">'page'</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">signIn</span><span class="p">.</span><span class="nx">renderEl</span><span class="p">(</span>
        <span class="p">{</span><span class="na">el</span><span class="p">:</span> <span class="s1">'#okta-login'</span><span class="p">},</span>
        <span class="kd">function</span> <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{},</span>
        <span class="kd">function</span> <span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
    <span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>baseUrl</td>
      <td>This is your Organization URL in Okta. It will be the URL of the admin pages without the <strong>-admin</strong> for example <code class="highlighter-rouge">https://{yourOktaDomain}.com</code></td>
    </tr>
    <tr>
      <td>clientId</td>
      <td>The client ID of the Okta application.</td>
    </tr>
    <tr>
      <td>redirectUri</td>
      <td>Where we will send the user to once they attempt a login.</td>
    </tr>
    <tr>
      <td>authParams.responseType</td>
      <td>What we want back from a successful login</td>
    </tr>
    <tr>
      <td>authParams.issuer</td>
      <td>The issuer of the authorization server. Can be retrieved from <strong>Admin -&gt; Security -&gt; API -&gt; Authorization Servers</strong></td>
    </tr>
    <tr>
      <td>authParams.display</td>
      <td>Redirect to the authorization server when an External Identity Provider button is clicked</td>
    </tr>
  </tbody>
</table>

<p>Now we can visit the <code class="highlighter-rouge">login.php</code> page and see the Sign-In Widget. You should be able to log into your main account. If you have a successful login, you will be redirected to our <code class="highlighter-rouge">oauth2-callback.php</code> page which is where we will go through the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.1">Authorization Code Flow</a> to get our <code class="highlighter-rouge">access_token</code>.</p>

<h2 id="responding-to-a-successful-login">Responding to a Successful Login.</h2>
<p>Next, we exchange the returned authorization code for an <code class="highlighter-rouge">access_token</code>. In this sample, we will use curl to do the exchange.</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code>$authHeaderSecret = base64_encode($clientId . ':' . $clientSecret);

$query = http_build_query([
    'grant_type' =&gt; 'authorization_code',
    'code' =&gt; $_GET['code'],
    'redirect_uri' =&gt; 'http://localhost:3000/oauth2-callback.php'
]);

$headers = [
    'Authorization: Basic ' . $authHeaderSecret,
    'Accept: application/json',
    'Content-Type: application/x-www-form-urlencoded',
    'Connection: close',
    'Content-Length: 0'
];
$url = 'https://{yourOktaDomain}.com/oauth2/{authorizationServerId}/v1/token?' . $query;

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_POST, 1);


$output = curl_exec($ch);
$httpcode = curl_getinfo($ch, CURLINFO_HTTP_CODE);

if(curl_error($ch))
{
	$httpcode = 500;
}
$decodedOutput = json_decode($output);
</code></pre>
</div>

<p>Now we have the <code class="highlighter-rouge">access_token</code> which we can use in our cookie to validate the user on future requests.</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code>setcookie('access_token', $decodedOutput-&gt;access_token, time() + $decodedOutput-&gt;expires_in, '/', "", false, true);
</code></pre>
</div>

<h2 id="validating-access-tokens">Validating Access Tokens</h2>

<p>Okta uses public key cryptography to sign tokens and verify that they are valid.</p>

<p>The resource server must validate the access token before allowing the client to access protected resources.</p>

<p>Access tokens are sensitive and can be misused if intercepted. Transmit them only over HTTPS and only via POST data or within request headers. If you store them on your application, you must store them securely.</p>

<p>An access token must be validated in the following manner:</p>

<ol>
  <li>Verify that the <code class="highlighter-rouge">iss</code> (issuer) claim matches the identifier of your authorization server.</li>
  <li>Verify that the <code class="highlighter-rouge">aud</code> (audience) claim is the requested URL.</li>
  <li>Verify <code class="highlighter-rouge">cid</code> (client id) claim is your client id.</li>
  <li>Verify the signature of the access token according to <a href="https://tools.ietf.org/html/rfc7515">JWS</a> using the algorithm specified in the JWT <code class="highlighter-rouge">alg</code> header property. Use the public keys provided by Okta via the <a href="/docs/api/resources/oauth2.html#get-keys">Get Keys endpoint</a>.</li>
  <li>Verify that the expiry time (from the <code class="highlighter-rouge">exp</code> claim) has not already passed.</li>
</ol>

<div class="language-php highlighter-rouge"><pre class="highlight"><code>if($res-&gt;claims['iss'] != 'https://{yourOktaDomain}.com/oauth2/{authorizationServerId}') {
    return $response-&gt;withStatus(401);
}

if($res-&gt;claims['aud'] != $oidcClientId) {
    return $response-&gt;withStatus(401);
}

if($res-&gt;claims['exp'] <span class="nt">&lt; time</span><span class="err">()</span><span class="na">-300</span><span class="err">)</span> <span class="err">{</span>
    <span class="na">return</span> <span class="err">$</span><span class="na">response-</span><span class="nt">&gt;</span>withStatus(401);
}

</code></pre>
</div>

<p>Step 4 involves downloading the public JWKS from Okta (specified by the <code class="highlighter-rouge">jwks_uri</code> property in the <a href="/docs/api/resources/oauth2.html#retrieve-authorization-server-metadata">authorization server metadata</a>. The result of this call is a <a href="https://tools.ietf.org/html/rfc7517">JSON Web Key</a> set.</p>

<p>An <code class="highlighter-rouge">id_token</code> contains a <a href="https://tools.ietf.org/html/rfc7517#section-4.5">public key id</a> (<code class="highlighter-rouge">kid</code>). To verify the signature, we use the <a href="/docs/api/resources/oidc.html#openid-connect-discovery-document">Discovery Document</a> to find the <code class="highlighter-rouge">jwks_uri</code>, which will return a list of public keys. It is safe to cache or persist these keys for performance, but Okta rotates them periodically. We strongly recommend dynamically retrieving these keys.</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code>$jwk = null;

 if($kidInCache) {
    $jwk = getKidFromCache($kid);
 }
else {

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'https://{yourOktaDomain}.com/oauth2/{authorizationServerId}/v1/keys');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_HEADER, 0);

    $output = curl_exec($ch);

    curl_close($ch);

    $output = json_decode($output);

    foreach ($output-&gt;keys as $key) {
        // poormans cache
        storeKidInCache($key-&gt;kid, $key);

        $cachedJwks[$key-&gt;kid] = $key;
        if ($key-&gt;kid == $kid) {
            $jwk = $key;
        }
    }
}
</code></pre>
</div>

<p>Once you have the <code class="highlighter-rouge">JWK</code> you can now verify the access token. Our example is using the <a href="https://packagist.org/packages/gree/jose">gree/jose</a> library.</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code>$jwt_string = 'eyJ...';
$jws = JOSE_JWT::decode($jwt_string);
$jws-&gt;verify($jwk, 'RS256');
</code></pre>
</div>

<p>Each public key is identified by a <code class="highlighter-rouge">kid</code> attribute, which corresponds with the <code class="highlighter-rouge">kid</code> claim in the <a href="/docs/api/resources/oauth2.html#token-authentication-methods">Access Token header</a>.</p>

<p>The access token is signed by an RSA private key, and we publish the future signing key well in advance.
However, in an emergency situation you can still stay in sync with Okta’s key rotation. Have your application check the <code class="highlighter-rouge">kid</code>, and if it has changed and the key is missing from the local cache, check the <code class="highlighter-rouge">jwks_uri</code> value in the <a href="/docs/api/resources/oauth2.html#retrieve-authorization-server-metadata">authorization server metadata</a> and you can go back to the <a href="/docs/api/resources/oauth2.html#get-keys">jwks uri</a> to get keys again from Okta</p>

<p>Please note the following:</p>

<ul>
  <li>For security purposes, Okta automatically rotates keys used to sign the token.</li>
  <li>The current key rotation schedule is four times a year. This schedule can change without notice.</li>
  <li>In case of an emergency, Okta can rotate keys as needed.</li>
  <li>Okta always publishes keys to the JWKS.</li>
  <li>To save the network round trip, your app can cache the JWKS response locally. The standard HTTP caching headers are used and should be respected.</li>
  <li>The administrator can switch the authorization server key rotation mode to <strong>MANUAL</strong> by <a href="/docs/api/resources/oauth2.html#update-authorization-server">updating the authorization server</a> and then control when to rotate the keys.</li>
</ul>

<p>Keys used to sign tokens automatically rotate and should always be resolved dynamically against the published JWKS. Your app can fail if you hardcode public keys in your applications. Be sure to include key rollover in your implementation.</p>

<h3 id="references">References</h3>

<ul>
  <li><a href="https://developer.okta.com/signup/">Sign Up For Okta</a></li>
  <li><a href="/docs/how-to/set-up-auth-server.html">Setting Up Authorization Server</a></li>
  <li><a href="https://github.com/nov/jose-php">Gree/Jose JWK Library</a></li>
  <li><a href="https://tools.ietf.org/html/rfc7515">JWS Spec</a></li>
  <li><a href="https://tools.ietf.org/html/rfc7519">JWT Spec</a></li>
  <li><a href="https://tools.ietf.org/html/rfc6749#section-1.3.1">Authorization Code Flow</a></li>
</ul>

      </div>
      <!-- END Page Content -->
    </section>
    <!-- END Page Center w/Sub Nav & Content -->
    <!-- START Footer -->
    <footer class="Footer">
    <div class="Wrap">

        <div class="Row">

            <div class="Column--3 Column--medium-6 Column--xSmall-12">

                <a class="Logo" href="https://www.okta.com/" target="_blank" rel="noopener noreferrer">
                    <img src="https://developer.okta.com/sites/all/themes/developer/images/logo-footer.png" alt="Okta">
                    Visit okta.com
                </a>

            </div>

            <div class="Column--3 Column--medium-12 Column--xSmall-12">

                <h4>Social</h4>
                <ul class="Footer-links Footer-links--social">
                    <li><a class="Footer-links--github" target="_blank" rel="noopener noreferrer" href="http://github.com/oktadeveloper">Github</a></li>
                    <li><a class="Footer-links--twitter" target="_blank" rel="noopener noreferrer" href="http://twitter.com/OktaDev">Twitter</a></li>
                    <li><a class="Footer-links--forum" target="_blank" rel="noopener noreferrer" href="https://devforum.okta.com/">Forum</a></li>
                    <li><a class="Footer-links--rss" target="_blank" rel="noopener noreferrer" href="http://feeds.feedburner.com/OktaBlog">RSS Blog</a></li>
                </ul>
            </div>

            <div class="Column--3 Column--medium-6 Column--small-12">
                <h4>More Info</h4>
                <ul class="Footer-links">
                    <li><a target="_blank" href="https://developer.okta.com/integrate-with-okta/">Integrate with Okta</a></li>
                    <li><a href="/blog/">Blog</a></li>
                    <li><a href="/docs/platform-release-notes/platform-release-notes.html">Release Notes</a></li>
                    <li><a href="/3rd_party_notices/">3rd Party Notices</a></li>
                </ul>
            </div>

            <div class="Column--3 Column--medium-6 Column--small-12">
                <h4>Contact &amp; Legal</h4>
                <ul class="Footer-links">
                    <li><a href="/contact/">Contact Sales</a></li>
                    <li><a target="_blank" rel="noopener noreferrer" href="mailto:developers@okta.com">Contact Support</a></li>
                    <li><a href="/terms/">Terms &amp; Conditions</a></li>
                    <li><a href="/privacy/">Privacy Policy</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script type="text/javascript" src="/assets/master-0365dd27cf276cb2a15c0a43906ca592538204cf1ad4557547bf4e50609b411e.js"></script>
    
    
    
    

    <!-- END Footer -->
  </div>
  <!-- START Post Footer -->
  
  <!-- START Google Tag Manager -->
  <!-- https://support.google.com/tagmanager/answer/6103696?hl=en -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- END Google Tag Manager -->
  <!-- START Google Remarketing Tag -->
  <script type="text/javascript">
    /* <![CDATA[ */
    var google_conversion_id = 1006913831;
    var google_custom_params = window.google_tag_params;
    var google_remarketing_only = true;
    /* ]]> */
  </script>
  <div style="display:none;"><script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script></div>
  <noscript><div style="display:inline;"><img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1006913831/?value=0&amp;guid=ON&amp;script=0"></div></noscript>
  <!-- END Google Remarketing Tag -->
  <!-- START Crazy Egg Tracking -->
  <script type="text/javascript">
    setTimeout(function(){var a=document.createElement("script");
    var b=document.getElementsByTagName("script")[0];
    a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0021/9333.js?"+Math.floor(new Date().getTime()/3600000);
    a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>
  <!-- END Crazy Egg Tracking -->

  <!-- END Post Footer -->
</body>
</html>
